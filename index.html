<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="theme-color" content="#000000">
<title>Oquefazer</title>
<link rel="icon" href="icone.png">
<link rel="apple-touch-icon" href="icone.png">
<link rel="manifest" href="manifest.json">
<style>
body {
margin: 0;
font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial, sans-serif;
background: url('fundo.jpg') center/cover no-repeat;
display: flex;
align-items: flex-end;
padding-bottom: 75px;
justify-content: center;
height: 100vh;
box-sizing: border-box;
overflow-y: hidden;
}
.container {
background: rgba(255, 255, 255, 0.85);
padding: 15px 30px;
border-radius: 25px;
box-shadow: 0 25px 60px rgba(0,0,0,0.25);
width: 90%;
max-width: 420px;
text-align: center;
}
h3 {
margin-bottom: 10px;
font-size: 22px;
color: #333;
}
.input-wrapper {
position: relative;
margin-bottom: 20px;
}
input {
width: 100%;
padding: 14px;
padding-right: 48px;
border-radius: 14px;
border: 1px solid #ddd;
font-size: 16px;
outline: none;
box-sizing: border-box;
}
input:focus {
border-color: #6eb233;
box-shadow: 0 0 0 3px rgba(110,179,51,0.2);
}
.geo-btn {
position: absolute;
right: 10px;
top: 50%;
transform: translateY(-50%);
background: none;
border: none;
cursor: pointer;
font-size: 22px;
padding: 0;
width: auto;
line-height: 1;
}
button {
width: 100%;
padding: 14px;
border: none;
border-radius: 14px;
font-size: 16px;
font-weight: bold;
cursor: pointer;
background: #6eb233;
color: white;
}
.share-btn {
margin-top: 10px;
background: white;
color: #6eb233;
border: 2px solid #6eb233;
}
.btn-group {
display: flex;
gap: 8px;
margin-bottom: 0;
}
.btn-group button {
font-size: 13px;
padding: 7px 6px;
}
.cat-group {
display: flex;
gap: 6px;
margin-bottom: 10px;
}
.cat-btn {
flex: 1;
font-size: 11px;
padding: 6px 2px;
background: white;
color: #6eb233;
border: 1.5px solid #6eb233;
border-radius: 14px;
cursor: pointer;
font-weight: bold;
width: auto;
}
.cat-btn.ativo {
background: #6eb233;
color: white;
}
.cidade-row {
display: flex;
gap: 8px;
margin-bottom: 10px;
align-items: center;
}
.cidade-row .input-wrapper {
flex: 1;
margin-bottom: 0;
}
.evento-btn {
width: auto;
padding: 14px 12px;
font-size: 13px;
white-space: nowrap;
flex-shrink: 0;
background: white;
color: #6eb233;
border: 1.5px solid #6eb233;
}
.evento-btn.ativo {
background: #6eb233;
color: white;
}
.evento-wrapper {
margin-bottom: 10px;
display: none;
}
.evento-wrapper input {
padding-right: 14px;
}
</style>
</head>
<body>

<div id="splash" style="
position: fixed;
top: 0; left: 0;
width: 100%; height: 100%;
background: #000000;
display: flex;
flex-direction: column;
align-items: center;
justify-content: center;
z-index: 9999;
transition: opacity 0.5s ease;
">
<img src="splash.png" style="width: 300px;">
</div>

<div class="container">
<h3>Eventos perto de vocÃª</h3>
<form onsubmit="return false;">
  <div class="cidade-row">
    <div class="input-wrapper">
      <input type="text" id="cidade">
      <button type="button" class="geo-btn" onclick="detectarCidade()" title="Detectar minha cidade">ğŸ”</button>
    </div>
    <button type="button" class="evento-btn" onclick="toggleEvento()">ğŸ« Evento</button>
  </div>
  <div class="evento-wrapper" id="eventoWrapper">
    <input type="text" id="evento" placeholder="Nome do evento ou artista">
  </div>
  <div class="cat-group">
    <button type="button" class="cat-btn" onclick="toggleCategoria(this, 'Bares')">ğŸ» Bares</button>
    <button type="button" class="cat-btn" onclick="toggleCategoria(this, 'Shows')">ğŸ¶ Shows</button>
    <button type="button" class="cat-btn" onclick="toggleCategoria(this, 'Cultura')">ğŸ­ Cultura</button>
  </div>
  <div class="cat-group">
    <button type="button" class="cat-btn" onclick="toggleCategoria(this, 'Natureza')">ğŸŒ± Natureza</button>
    <button type="button" class="cat-btn" onclick="toggleCategoria(this, 'Esporte')">ğŸ¾ Esporte</button>
    <button type="button" class="cat-btn" onclick="toggleCategoria(this, 'Feiras')">ğŸª Feiras</button>
  </div>
  <div class="btn-group">
    <button type="button" onclick="buscar('hoje')" style="flex:1">Hoje</button>
    <button type="button" onclick="buscar('fimdesemana')" style="flex:2">Fim de semana</button>
    <button type="button" onclick="buscar('7dias')" style="flex:1">7 dias</button>
  </div>
  <p style="margin-top: 10px; font-size: 14px; color: #555;">
    IA pode trazer eventos diferentes a cada busca
  </p>
  <p style="margin-top: 25px; font-size: 14px; color: #555;">
    <a href="https://www.instagram.com/joseaugustobaron/" target="_blank" style="color: #6eb233; text-decoration: none;">@joseaugustobaron</a>
    &nbsp;&nbsp;&nbsp;
    <a onclick="compartilhar(); return false;" href="#" style="color: #6eb233; text-decoration: none;">ğŸ”— Indique o app</a>
  </p>
</form>
</div>

<!-- Modal -->
<div id="modal" onclick="if(event.target===this)this.style.display='none';" style="
position: fixed;
top: 0; left: 0; width: 100%; height: 100%;
background: rgba(0,0,0,0.6);
display: none;
align-items: center; justify-content: center;
z-index: 10000;
">
<div style="
background: white;
padding: 25px 20px;
border-radius: 20px;
text-align: center;
max-width: 300px;
box-shadow: 0 10px 30px rgba(0,0,0,0.25);
">
<p style="margin-bottom: 20px; font-size: 16px; color: #333;">
Por favor, digite uma cidade
</p>
<button onclick="document.getElementById('modal').style.display='none'; document.getElementById('cidade').focus();" style="
padding: 7px 14px;
border: none;
border-radius: 10px;
font-size: 13px;
font-weight: bold;
cursor: pointer;
background: #6eb233;
color: white;
width: auto;
">Entendi</button>
</div>
</div>

<script>
let categoriaSelecionada = '';

function toggleEvento() {
  const cats = document.querySelectorAll('.cat-btn');
  const wrapper = document.getElementById('eventoWrapper');
  const btn = document.querySelector('.evento-btn');
  if (wrapper.style.display === 'none' || wrapper.style.display === '') {
    wrapper.style.display = 'block';
    document.getElementById('evento').focus();
    btn.classList.add('ativo');
    cats.forEach(b => {
      b.classList.remove('ativo');
      b.disabled = true;
      b.style.opacity = '0.4';
      b.style.cursor = 'not-allowed';
    });
    categoriaSelecionada = '';
  } else {
    wrapper.style.display = 'none';
    document.getElementById('evento').value = '';
    btn.classList.remove('ativo');
    cats.forEach(b => {
      b.disabled = false;
      b.style.opacity = '1';
      b.style.cursor = 'pointer';
    });
  }
}

function toggleCategoria(btn, categoria) {
  const todos = document.querySelectorAll('.cat-btn');
  if (categoriaSelecionada === categoria) {
    btn.classList.remove('ativo');
    categoriaSelecionada = '';
  } else {
    todos.forEach(b => b.classList.remove('ativo'));
    btn.classList.add('ativo');
    categoriaSelecionada = categoria;
  }
}

function buscar(periodo) {
const cidade = document.getElementById("cidade").value.trim();
if (!cidade) {
document.getElementById('modal').style.display = 'flex';
return;
}

localStorage.setItem('cidade', cidade);

let tempo;
if (periodo === 'hoje') {
  tempo = 'hoje';
} else if (periodo === 'fimdesemana') {
  tempo = 'neste fim de semana (sexta, sÃ¡bado e domingo)';
} else {
  tempo = 'nos prÃ³ximos 7 dias a partir de hoje';
}

const eventoEspecifico = document.getElementById('evento').value.trim();

let query;
if (eventoEspecifico) {
  query = `Buscar APENAS informaÃ§Ãµes sobre: ${eventoEspecifico} em ${cidade} ${tempo}. Mostrar somente este evento. NÃ£o mostrar outros eventos. Informar: data, horÃ¡rio, local, descriÃ§Ã£o e links. Se nÃ£o encontrar, informar claramente que nÃ£o hÃ¡ informaÃ§Ãµes confirmadas sobre este evento.`;
} else {
  const filtroCategoria = categoriaSelecionada ? ` Mostrar apenas eventos da categoria: ${categoriaSelecionada}.` : '';
  query = `Todos os eventos reais em ${cidade} ${tempo}, em ordem cronolÃ³gica no formato ğŸ“† calendÃ¡rio. NÃ£o invente eventos. Incluir shows, cultura, gastronomia, restaurantes, bares, esportes, feiras, festivais, mercados, exposiÃ§Ãµes, workshops. Apenas eventos com data confirmada. Para cada evento: data, horÃ¡rio, local e link. Para restaurantes: incluir especialidade. Categorias: ğŸ» Bares, ğŸ¶ Shows, ğŸ­ Cultura, ğŸŒ± Natureza, ğŸ¾ Esporte, ğŸª Feiras. Para cada evento incluir pelo menos um link. Se houver mais, incluir todos: site oficial, Instagram, Sympla, Eventbrite ou site da prefeitura. Se nÃ£o houver eventos confirmados, informar claramente que nÃ£o hÃ¡ eventos oficiais encontrados.${filtroCategoria}`;
}

const url = "https://www.google.com/search?udm=50&hl=pt-BR&q=" + encodeURIComponent(query);
location.href = url;
}

function detectarCidade() {
if (!navigator.geolocation) {
alert('GeolocalizaÃ§Ã£o nÃ£o suportada neste dispositivo.');
return;
}
const btn = document.querySelector('.geo-btn');
btn.textContent = 'â³';
navigator.geolocation.getCurrentPosition(async (pos) => {
const { latitude, longitude } = pos.coords;
try {
const res = await fetch(`https://nominatim.openstreetmap.org/reverse?lat=${latitude}&lon=${longitude}&format=json`);
const data = await res.json();
const cidade = data.address.city || data.address.town || data.address.village || data.address.county;
if (cidade) {
document.getElementById('cidade').value = cidade;
localStorage.setItem('cidade', cidade);
}
} catch(e) {
alert('NÃ£o foi possÃ­vel detectar a cidade.');
} finally {
btn.textContent = 'ğŸ”';
}
}, () => {
alert('PermissÃ£o de localizaÃ§Ã£o negada.');
btn.textContent = 'ğŸ”';
});
}

function compartilhar() {
const texto = 'Descubra eventos na sua cidade! ğŸ‘‰ https://joaubaron.github.io/oquefazer/';
if (navigator.share) {
navigator.share({ text: texto });
} else {
navigator.clipboard.writeText(texto).then(() => alert('Link copiado!'));
}
}
</script>

<script>
window.addEventListener('DOMContentLoaded', () => {
  const ultima = localStorage.getItem('cidade');
  document.getElementById('cidade').value = ultima || 'Blumenau';
});
</script>

<script>
window.addEventListener('load', () => {
setTimeout(() => {
const splash = document.getElementById('splash');
splash.style.opacity = '0';
splash.style.pointerEvents = 'none';
setTimeout(() => splash.remove(), 500);
}, 3000);
});
</script>

<script>
if ('serviceWorker' in navigator) {
navigator.serviceWorker.register('/oquefazer/sw.js');
}
</script>
</body>
</html>
